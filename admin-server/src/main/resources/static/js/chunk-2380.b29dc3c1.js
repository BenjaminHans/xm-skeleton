(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2380"],{"28a5":function(e,t,a){a("214f")("split",2,function(e,t,l){"use strict";var o=a("aae3"),r=l,s=[].push,n="split",i="length",c="lastIndex";if("c"=="abbc"[n](/(b)*/)[1]||4!="test"[n](/(?:)/,-1)[i]||2!="ab"[n](/(?:ab)*/)[i]||4!="."[n](/(.?)(.?)/)[i]||"."[n](/()()/)[i]>1||""[n](/.?/)[i]){var d=void 0===/()??/.exec("")[1];l=function(e,t){var a=String(this);if(void 0===e&&0===t)return[];if(!o(e))return r.call(a,e,t);var l,n,m,g,h,u=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),F=0,b=void 0===t?4294967295:t>>>0,v=new RegExp(e.source,p+"g");d||(l=new RegExp("^"+v.source+"$(?!\\s)",p));while(n=v.exec(a)){if(m=n.index+n[0][i],m>F&&(u.push(a.slice(F,n.index)),!d&&n[i]>1&&n[0].replace(l,function(){for(h=1;h<arguments[i]-2;h++)void 0===arguments[h]&&(n[h]=void 0)}),n[i]>1&&n.index<a[i]&&s.apply(u,n.slice(1)),g=n[0][i],F=m,u[i]>=b))break;v[c]===n.index&&v[c]++}return F===a[i]?!g&&v.test("")||u.push(""):u.push(a.slice(F)),u[i]>b?u.slice(0,b):u}}else"0"[n](void 0,0)[i]&&(l=function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)});return[function(a,o){var r=e(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,r,o):l.call(String(r),a,o)},l]})},"9c0a":function(e,t,a){"use strict";var l=a("ff01"),o=a.n(l);o.a},edc7:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search"},[a("Row",[a("Col",[a("Card",[a("Row",[a("Form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,inline:"","label-width":70}},[a("Form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"手机号"},model:{value:e.searchForm.mobile,callback:function(t){e.$set(e.searchForm,"mobile",t)},expression:"searchForm.mobile"}})],1),a("Form-item",{attrs:{label:"UID",prop:"mobile"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"UID"},model:{value:e.searchForm.id,callback:function(t){e.$set(e.searchForm,"id",t)},expression:"searchForm.id"}})],1),a("Form-item",{attrs:{label:"代理等级",prop:"level"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择等级",clearable:""},model:{value:e.searchForm.level,callback:function(t){e.$set(e.searchForm,"level",t)},expression:"searchForm.level"}},[a("Option",{attrs:{value:"2"}},[e._v("会员")]),a("Option",{attrs:{value:"3"}},[e._v("店长")]),a("Option",{attrs:{value:"4"}},[e._v("区/县渠道商")]),a("Option",{attrs:{value:"5"}},[e._v("市级渠道商")]),a("Option",{attrs:{value:"6"}},[e._v("省级渠道商")])],1)],1),a("Form-item",{attrs:{label:"代理区域",prop:"area"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"代理区域"},model:{value:e.searchForm.area,callback:function(t){e.$set(e.searchForm,"area",t)},expression:"searchForm.area"}})],1),e.drop?a("span",[a("Form-item",{attrs:{label:"姓名",prop:"mobile"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"姓名"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),a("Form-item",{attrs:{label:"昵称",prop:"mobile"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"昵称"},model:{value:e.searchForm.nickname,callback:function(t){e.$set(e.searchForm,"nickname",t)},expression:"searchForm.nickname"}})],1),a("Form-item",{attrs:{label:"推荐手机",prop:"recommendMobile"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"推荐人手机号",readonly:e.recommendReadonly},model:{value:e.searchForm.recommendMobile,callback:function(t){e.$set(e.searchForm,"recommendMobile",t)},expression:"searchForm.recommendMobile"}})],1)],1):e._e(),a("Form-item",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.handleSearch}},[e._v("搜索")]),a("Button",{on:{click:e.handleReset}},[e._v("重置")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.getAgentList}},[e._v("刷新")]),a("a",{staticClass:"drop-down",on:{click:e.dropDown}},[e._v(e._s(e.dropDownContent)+"\n                                "),a("Icon",{attrs:{type:e.dropDownIcon}})],1)],1)],1)],1),a("Row",{staticClass:"operation"},[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.add}},[e._v("添加代理")]),a("Dropdown",{on:{"on-click":e.handleDropdown}},[a("Button",[e._v("\n                            更多操作\n                            "),a("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"refresh"}},[e._v("刷新")]),a("DropdownItem",{attrs:{name:"exportData"}},[e._v("导出所选数据")])],1)],1)],1),a("Row",[a("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data,sortable:"custom"},on:{"on-sort-change":e.changeSort,"on-selection-change":e.showSelect}}),a("Table",{ref:"exportTable",staticStyle:{display:"none"},attrs:{columns:e.columns,data:e.exportData}})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{current:e.searchForm.pageNumber,total:e.total,"page-size":e.searchForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)],1),a("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1,width:500,styles:{top:"30px"}},on:{"on-cancel":e.cancelAgent},model:{value:e.modalFlag,callback:function(t){e.modalFlag=t},expression:"modalFlag"}},[a("Form",{ref:"agentForm",attrs:{model:e.agentForm,"label-width":70,rules:e.agentFormValidate}},[e.editMobileFlag||e.addFlag?a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{attrs:{autocomplete:"off",placeholder:"手机号"},on:{"on-blur":e.getRecommend},model:{value:e.agentForm.mobile,callback:function(t){e.$set(e.agentForm,"mobile",t)},expression:"agentForm.mobile"}})],1):e._e(),e.addFlag?a("FormItem",{attrs:{label:"姓名",prop:"name"}},[a("Input",{attrs:{autocomplete:"off",placeholder:"姓名"},model:{value:e.agentForm.name,callback:function(t){e.$set(e.agentForm,"name",t)},expression:"agentForm.name"}})],1):e._e(),a("input",{directives:[{name:"model",rawName:"v-model",value:e.agentForm.id,expression:"agentForm.id"}],attrs:{type:"hidden"},domProps:{value:e.agentForm.id},on:{input:function(t){t.target.composing||e.$set(e.agentForm,"id",t.target.value)}}}),e.editRecommendFlag||e.addFlag?a("FormItem",{attrs:{label:"推荐人",prop:"recommendMobile"}},[a("Input",{attrs:{autocomplete:"off",placeholder:"推荐人手机号或UID"},on:{"on-blur":e.checkRecommend},model:{value:e.agentForm.recommendMobile,callback:function(t){e.$set(e.agentForm,"recommendMobile",t)},expression:"agentForm.recommendMobile"}})],1):e._e(),e.editLevelFlag||e.addFlag?a("FormItem",{attrs:{label:"代理等级",prop:"level"}},[a("Select",{attrs:{placeholder:"代理等级"},on:{"on-change":function(t){e.changeLevel()}},model:{value:e.agentForm.level,callback:function(t){e.$set(e.agentForm,"level",t)},expression:"agentForm.level"}},[a("Option",{attrs:{value:"2"}},[e._v("会员")]),a("Option",{attrs:{value:"3"}},[e._v("店长")]),a("Option",{attrs:{value:"4"}},[e._v("区/县渠道商")]),a("Option",{attrs:{value:"5"}},[e._v("市级渠道商")]),a("Option",{attrs:{value:"6"}},[e._v("省级渠道商")])],1)],1):e._e(),(e.addFlag||e.editLevelFlag)&&e.selectAreaFlag?a("FormItem",{attrs:{label:"选择地区",prop:"address"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:6==e.agentForm.level,expression:"agentForm.level == 6"}]},[a("al-cascader",{staticStyle:{width:"250px"},attrs:{"data-type":"code",level:0},on:{"on-change":e.changeAddress},model:{value:e.agentForm.addressArray,callback:function(t){e.$set(e.agentForm,"addressArray",t)},expression:"agentForm.addressArray"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:5==e.agentForm.level,expression:"agentForm.level == 5"}]},[a("al-cascader",{staticStyle:{width:"250px"},attrs:{"data-type":"code",level:1},on:{"on-change":e.changeAddress},model:{value:e.agentForm.addressArray,callback:function(t){e.$set(e.agentForm,"addressArray",t)},expression:"agentForm.addressArray"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:4==e.agentForm.level,expression:"agentForm.level == 4"}]},[a("al-cascader",{staticStyle:{width:"250px"},attrs:{"data-type":"code",level:2},on:{"on-change":e.changeAddress},model:{value:e.agentForm.addressArray,callback:function(t){e.$set(e.agentForm,"addressArray",t)},expression:"agentForm.addressArray"}})],1)]):e._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:e.cancelAgent}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submitAgent}},[e._v("提交")])],1)],1),a("Modal",{attrs:{title:e.disableTitle,"mask-closable":!1,width:500,styles:{top:"30px"}},on:{"on-cancel":e.cancelDisable},model:{value:e.disableFlag,callback:function(t){e.disableFlag=t},expression:"disableFlag"}},[a("Form",{ref:"disableForm",attrs:{model:e.disableForm,"label-width":70,rules:e.disableFormValidate}},[a("FormItem",{attrs:{label:"代理等级",prop:"level"}},[a("Select",{attrs:{placeholder:"禁用前，请选择一个代理等级"},model:{value:e.disableForm.level,callback:function(t){e.$set(e.disableForm,"level",t)},expression:"disableForm.level"}},[a("Option",{attrs:{value:"2"}},[e._v("会员")]),a("Option",{attrs:{value:"3"}},[e._v("店长")])],1),a("input",{directives:[{name:"model",rawName:"v-model",value:e.disableForm.id,expression:"disableForm.id"}],attrs:{type:"hidden"},domProps:{value:e.disableForm.id},on:{input:function(t){t.target.composing||e.$set(e.disableForm,"id",t.target.value)}}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:e.cancelDisable}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.doDisable}},[e._v("提交")])],1)],1)],1)},o=[],r=(a("7f7f"),a("28a5"),a("cadf"),a("551c"),a("097d"),a("365c")),s=a("c1df"),n={name:"help-manage",data:function(){var e=this;return{accessToken:{},loading:!0,editor:"",drop:!1,fullscreen:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",disableFlag:!1,disableTitle:"禁用区域代理",selectCount:0,selectList:[],modalFlag:!1,addFlag:!1,editMobileFlag:!1,editRecommendFlag:!1,editLevelFlag:!1,selectAreaFlag:!1,recommendReadonly:!1,searchForm:{name:"",mobile:"",nickname:"",recommendMobile:"",status:-1,level:null},selectDate:null,modalType:0,agentModalVisible:!1,modalTitle:"",agentForm:{mobile:null,recommendMobile:"",level:"",address:"",addressArray:[],selectLevel:0,name:""},disableForm:{id:null,level:""},disableFormValidate:{level:[{required:!0,message:"禁用区域代理前，请先选择一个普通代理等级",trigger:"blur"}]},agentFormValidate:{mobile:[{required:!0,message:"代理手机号不能为空",trigger:"blur"}],recommendMobile:[{required:!0,message:"推荐人手机号不能为空",trigger:"blur"}],level:[{required:!0,message:"等级不能为空",trigger:"blur"}]},editMobileFormValidate:{mobile:[{required:!0,message:"代理手机号不能为空"}]},editRecommendFormValidate:{recommendMobile:[{required:!0,message:"推荐人手机号不能为空",trigger:"blur"}]},editLevelFormValidate:{level:[{required:!0,message:"请选择等级"}]},submitLoading:!1,columns:[{type:"selection",width:60,align:"center",fixed:"left"},{title:"UID",key:"id",align:"center",sortable:!0},{title:"手机号",key:"mobile",align:"center",sortable:!0},{title:"昵称",key:"nickname",align:"center",sortable:!0},{title:"姓名",key:"name",sortable:!0,align:"center",type:"html"},{title:"代理等级",key:"level",align:"center",render:function(e,t){var a="";return 1===t.row.level?a="游客":2===t.row.level?a="会员":3===t.row.level?a="店长":4===t.row.level?a="区/县渠道商":5===t.row.level?a="市级渠道商":6===t.row.level&&(a="省级渠道商"),e("div",a)}},{title:"代理区域",key:"areaNames",sortable:!0,align:"center",type:"html",width:200,render:function(e,t){var a="";return a=""!==t.row.areaNames?t.row.areaNames:"-",e("div",a)}},{title:"推荐人手机",key:"recommendMobile",sortable:!0,align:"center",type:"html"},{title:"推荐人昵称",key:"recommendNickname",sortable:!0,align:"center",type:"html"},{title:"注册时间",key:"ctime",sortable:!0,width:150,render:function(e,t){return e("div",s.unix(t.row.ctime).format("YYYY-MM-DD HH:mm:ss"))}},{title:"操作",key:"action",width:400,align:"center",fixed:"right",render:function(t,a){var l=[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(a.row,"mobile")}}},"修改手机号"),t("Button",{props:{type:"default",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(a.row,"recommendMobile")}}},"修改推荐人"),t("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(a.row,"level"),e.changeLevel()}}},"修改等级")];return a.row.address&&(1===a.row.areaStatus?l.push(t("Button",{props:{type:"default",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.disable(a.row)}}},"禁用区域代理")):l.push(t("Button",{props:{type:"default",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.enable(a.row)}}},"启用区域代理"))),t("div",l)}}],data:[],exportData:[],total:0}},methods:{init:function(){this.accessToken={accessToken:this.getStore("accessToken")},this.getAgentList()},changePage:function(e){this.searchForm.pageNumber=e,this.getAgentList(),this.clearSelectAll()},changePageSize:function(e){this.searchForm.pageSize=e,this.getAgentList()},selectDateRange:function(e){e&&(this.searchForm.startDate=e[0],this.searchForm.endDate=e[1])},getAgentList:function(){var e=this;this.loading=!0,Object(r["H"])(this.searchForm).then(function(t){e.loading=!1,!0===t.success&&(e.data=t.result.records,e.total=t.result.total)})},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getAgentList()},handleReset:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.selectDate=null,this.searchForm.startDate="",this.searchForm.endDate="",this.selectDep=[],this.searchForm.departmentId="",this.getAgentList()},changeSort:function(e){this.searchForm.sort=e.key,this.searchForm.order=e.order,"normal"===e.order&&(this.searchForm.order=""),this.getAgentList()},handleDropdown:function(e){var t=this;if("exportData"===e){if(this.selectCount<=0)return void this.$Message.warning("您还未选择要导出的数据");this.$Modal.confirm({title:"确认导出",content:"您确认要导出所选 "+this.selectCount+" 条数据?",onOk:function(){t.$refs.exportTable.exportCsv({filename:"代理数据"})}})}else"refresh"===e&&this.getAgentList()},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},showSelect:function(e){this.exportData=e,this.selectList=e,this.selectCount=e.length},clearSelectAll:function(){this.$refs.table.selectAll(!1)},cancelAgent:function(){this.modalFlag=!1,this.addFlag=!1,this.editMobileFlag=!1,this.editRecommendFlag=!1,this.editLevelFlag=!1,this.selectAreaFlag=!1,this.agentForm.mobile="",this.agentForm.recommendMobile="",this.agentForm.level="",this.agentForm.address="",this.agentForm.addressArray=[]},submitAgent:function(){var e=this;this.$refs.agentForm.validate(function(t){t&&(0===e.modalType?(delete e.agentForm.id,delete e.agentForm.nickname,delete e.agentForm.ctime,delete e.agentForm.status,e.submitLoading=!0,Object(r["a"])(e.agentForm).then(function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.getAgentList(),e.cancelAgent())})):(delete e.agentForm.status,e.editLevelFlag?Object(r["w"])(e.agentForm).then(function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.getAgentList(),e.cancelAgent())}):e.editMobileFlag?Object(r["x"])(e.agentForm).then(function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.getAgentList(),e.cancelAgent())}):e.editRecommendFlag&&Object(r["A"])(e.agentForm).then(function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.getAgentList(),e.cancelAgent())})))})},changeLevel:function(){this.selectAreaFlag=!1,this.agentForm.level>3&&(4==this.agentForm.level?this.agentForm.selectLevel=2:5==this.agentForm.level?this.agentForm.selectLevel=1:6==this.agentForm.level&&(this.agentForm.selectLevel=0),this.selectAreaFlag=!0)},add:function(){this.modalType=0,this.modalTitle="添加代理",this.$refs.agentForm.resetFields(),this.modalFlag=!0,this.addFlag=!0,this.agentForm.name=""},edit:function(e,t){for(var a in this.modalType=1,this.$refs.agentForm.resetFields(),e)null===e[a]&&(e[a]="");var l=JSON.stringify(e),o=JSON.parse(l);this.agentForm=o,4===this.agentForm.level?this.agentForm.selectLevel=2:5===this.agentForm.level?this.agentForm.selectLevel=1:6===this.agentForm.level&&(this.agentForm.selectLevel=0),this.agentForm.level=o.level+"",null!==o.address&&""!==o.address&&o.address?(this.agentForm.address=o.address,this.agentForm.addressArray=o.address.split(","),this.agentForm.selectAreaFlag=!0):(this.agentForm.addressArray=[],this.agentForm.address=""),this.modalFlag=!0,"mobile"===t?(this.modalTitle="修改手机号",this.editMobileFlag=!0):"recommendMobile"===t?(this.editRecommendFlag=!0,this.modalTitle="修改推荐人"):"level"===t&&(this.editLevelFlag=!0,this.modalTitle="修改等级")},enable:function(e){var t=this;this.$Modal.confirm({title:"确认启用",content:"您确认要启用区域代理 "+e.mobile+" ?",onOk:function(){Object(r["E"])(e.id).then(function(e){!0===e.success&&(t.$Message.success("操作成功"),t.getAgentList())})}})},disable:function(e){this.disableFlag=!0,this.disableForm.id=e.id},changeAddress:function(){this.agentForm.address=JSON.stringify(this.agentForm.addressArray)},checkRecommend:function(){var e=this,t={recommendMobile:this.agentForm.recommendMobile};Object(r["i"])(t).then(function(t){!0===t.success&&e.$Message.success("推荐人: "+t.result+" 有效")})},getRecommend:function(){var e=this,t={mobile:this.agentForm.mobile};Object(r["Q"])(t).then(function(t){null!=t.result?(null!=t.result.name&&(e.agentForm.name=t.result.name),null!=t.result.recommendMobile&&(e.agentForm.recommendMobile=t.result.recommendMobile),e.recommendReadonly=!0):(e.recommendReadonly=!1,e.agentForm.recommendMobile="",e.agentForm.name="")})},cancelDisable:function(){this.disableFlag=!1,this.disableForm.level="",this.disableForm.id=null},doDisable:function(){var e=this;this.$refs.disableForm.validate(function(t){t&&(e.disableFlag=!1,Object(r["r"])(e.disableForm.id,e.disableForm.level).then(function(t){!0===t.success&&(e.$Message.success("操作成功"),e.getAgentList(),e.disableForm.id=null,e.disableForm.level="")}))})}},mounted:function(){this.init()}},i=n,c=(a("9c0a"),a("2877")),d=Object(c["a"])(i,l,o,!1,null,null,null);d.options.__file="agentManage.vue";t["default"]=d.exports},ff01:function(e,t,a){}}]);